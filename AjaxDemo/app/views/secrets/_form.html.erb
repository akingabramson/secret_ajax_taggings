
<%= form_for(
			@secret,
			:remote => :true,
			:html => { :class => "new_secret_form" }) do |f| %>


 <div class="notice"></div>

 <p>
	 <%= f.label :title %>
	 <%= f.text_field :title %>
 </p>

 <p>
	 <label for="secret_recipient">Recipient:</label>
	 <select name="secret[recipient_id]" id="secret_recipient">
		 <% @users.each do |user| %>
		 	 <option value="<%= user.id %>"><%= user.username %></option>
		 <% end %>
	 </select>

	 <p>
		 <%= f.submit %>
	 </p>

<% end %>

<script type="text/javascript">
	// add secret
	$(".new_secret_form").on('ajax:before', function (event, data) {
		var $submitButton = $(event.target).find("input[type='submit']");
		$submitButton.val("Adding Secret ...");
	});

	$(".new_secret_form").on("ajax:success", function (event, data) {
		// debugger;
		$(event.target).find("#secret_title").val("");

		var $submitButton = $(event.target).find("input[type='submit']");
		$submitButton.val("Add Secret");

		$(".new_secret_form .notice").html("Secret posted!")
	});
</script>
